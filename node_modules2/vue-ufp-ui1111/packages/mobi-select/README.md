# ui-mobiSelect

## 概述
移动端下拉选择组件

## 安装
```bash
npm i vue-ufp-ui-mobi-select
```
## 配置
::: demo 在`ufp-framework.js`文件中添加如下配置

```javascript
module.exports = {
  plugins: [
    ['ui', {
      components: [
        'mobi-select'
      ]
    }]
  ]
}
```
:::


<script>
  export default {
    data () {
      function makeData (min, max, hz) {
        let backData = []
        for (let i = min; i <= max; i++) {
          backData.push({
            id: i, label: i + hz
          })
        }
        return backData
      }
      return {
        selectDatas1: [[
          {id: 1, label: '苹果'}, // 可以为任意对象，取数据中的label作为列表中的显示数据
          {id: 2, label: '火龙果'},
          {id: 3, label: '西瓜'}
        ]],
        adress: '',
        adressObj: [],
        showAdr: false,
        selectDatas: [makeData(0, 23, '时'), makeData(0, 59, '分'), makeData(0, 59, '秒')],
        dateText: '5时15分23秒',
        selecteds: [5, 15, 23],
        showDate: false,
        selectDatas3: [[], []],
        partDatas: [],
        selectedData3: [],
        rowTitle: ['省', '市'],
        adrText3: '',
        showAdr3: false,
        loadStatus: false
      }
    },
    methods: {
      showAdress () {
        this.showAdr = true
      },
      action1 (opts) {
        if (opts.type === 'submit') {
          this.adress = opts.data[0].label
          this.adressObj = opts.data
          this.showAdr = false
        }
      },
      showDateBox () {
        this.showDate = true
      },
      action2 (opts) {
        if (opts.type === 'change') {
          console.log('change', opts.target, opts.data)
        } else if (opts.type === 'submit') {
          this.dateText = opts.data[0].label + opts.data[1].label + opts.data[2].label
          this.selecteds = opts.data
          this.showDate = false
        } else if (opts.type === 'cancel') {
          this.showDate = false
        }
      },
      initData () {
       this.ajax('prov', {}).then((res) => {
          this.$set(this.selectDatas3, 0, res)
          this.ajax('city', {prov: res[0].value}).then((cityRes) => {
            const localCityData = cityRes['key' + res[0].value]
            this.$set(this.selectDatas3, 1, localCityData)
          })
        })
      },
      getCity (prov) {
        if (prov) {
          this.loadStatus = true
          this.ajax('city', {prov: prov.value}).then((cityRes) => {
            this.loadStatus = false
            const localCityData = cityRes['key' + prov.value]
            this.partDatas = [null, localCityData]
          })
        }
      },
      showAdrSelect3 () {
        this.showAdr3 = true
      },
      action3 (opts) {
        if (opts.type === 'change') {
          if (opts.target === 0) {
            this.getCity(opts.data[0])
          }
        } else if (opts.type === 'submit') {
          this.adrText3 = opts.data[0].label + opts.data[1].label
          this.selectedData3 = opts.data
          this.showAdr3 = false
        } else if (opts.type === 'cancel') {
          this.showAdr3 = false
        }
      }
    },
    mounted () {
      this.initData()
    }
  }
</script>





## 使用
示例1(简单示例)
::: demo 示例1(简单示例)
```html
<template>
<div>
  <div>选择水果：
    <input name="adress" v-model="adress" @focus="showAdress"/>
  </div>
  <cbm-select v-if="showAdr" :selectDatas="selectDatas1" :selecteds="adressObj" title="选择水果" @action="action1"></cbm-select>
</div></template>
<script>
  export default {
    data () {
      return {
        selectDatas1: [[
          {id: 1, label: '苹果'}, // 可以为任意对象，取数据中的label作为列表中的显示数据
          {id: 2, label: '火龙果'},
          {id: 3, label: '西瓜'}
        ]],
        adress: '',
        adressObj: [],
        showAdr: false
      }
    },
    methods: {
      showAdress () {
        this.showAdr = true
      },
      action1 (opts) {
        console.log(opts, 122)
        if (opts.type === 'submit') {
          this.adress = opts.data[0].label
          this.adressObj = opts.data
          this.showAdr = false
        }
      }
    }
  }
</script>
```
:::

::: demo 时间
```html
<template>
  <div>
    <div>选择时间：
      <input name="adress" v-model="dateText" @focus="showDateBox"/>
    </div>
    <cbm-select v-if="showDate" :selectDatas="selectDatas" :selecteds="selecteds" title="选择时间" @action="action2"></cbm-select>
  </div> 
</template>
<script>
  export default {
    data () {
      function makeData (min, max, hz) {
        let backData = []
        for (let i = min; i <= max; i++) {
          backData.push({
            id: i, label: i + hz
          })
        }
        return backData
      }
      return {
        selectDatas: [makeData(0, 23, '时'), makeData(0, 59, '分'), makeData(0, 59, '秒')],
        dateText: '5时15分23秒',
        selecteds: [5, 15, 23],
        showDate: false
      }
    },
    methods: {
      showDateBox () {
        this.showDate = true
      },
      action2 (opts) {
        if (opts.type === 'change') {
          console.log('change', opts.target, opts.data)
        } else if (opts.type === 'submit') {
          this.dateText = opts.data[0].label + opts.data[1].label + opts.data[2].label
          this.selecteds = opts.data
          this.showDate = false
        } else if (opts.type === 'cancel') {
          this.showDate = false
        }
      }
    }
  }
</script>
```
:::

::: demo 异步加载
``` html
<template>
  <div>
    <div>选择地区：
      <input name="startdata" v-model="adrText3" @focus="showAdrSelect3"/>
    </div>
    <cbm-select v-if="showAdr3" :selectDatas="selectDatas3" :selecteds="selectedData3" :partDatas="partDatas" :isLoading="loadStatus" title="选择地址" :rowTitle="rowTitle" @action="action3"></cbm-select>
  </div> 
</template>

<script>
  export default {
    data () {
      return {
        selectDatas3: [[], []],
        partDatas: [],
        selectedData3: [],
        rowTitle: ['省', '市'],
        adrText3: '',
        showAdr3: false,
        loadStatus: false
      }
    },
    mounted () {
      this.initData()
    },
    methods: {
      initData () {
       this.ajax('prov', {}).then((res) => {
          this.$set(this.selectDatas3, 0, res)
          this.ajax('city', {prov: res[0].value}).then((cityRes) => {
            const localCityData = cityRes['key' + res[0].value]
            this.$set(this.selectDatas3, 1, localCityData)
          })
        })
      },
      getCity (prov) {
        if (prov) {
          this.loadStatus = true
          this.ajax('city', {prov: prov.value}).then((cityRes) => {
            this.loadStatus = false
            const localCityData = cityRes['key' + prov.value]
            this.partDatas = [null, localCityData]
          })
        }
      },
      showAdrSelect3 () {
        this.showAdr3 = true
      },
      action3 (opts) {
        if (opts.type === 'change') {
          if (opts.target === 0) {
            this.getCity(opts.data[0])
          }
        } else if (opts.type === 'submit') {
          this.adrText3 = opts.data[0].label + opts.data[1].label
          this.selectedData3 = opts.data
          this.showAdr3 = false
        } else if (opts.type === 'cancel') {
          this.showAdr3 = false
        }
      }
    }
  }
</script>
```
:::

## 参数
|参数名|类型|默认值|说明|备注
|:-----:|:---:|:------:|:------|:----------
|selectDatas|(Array)|-|选择框的数据|数组中每项也必须是数组
|selecteds|[Array]|-|选中项列表|选中项可以为序号(int)或对象(Object)
|partDatas|[Array]|-|部分选择框的数据|用于部分更新选框数据,中间可以出现空,会重置已选项到第一个
|title|[String]|''|选择框标题|不支持html标签
|rowTitle|[Array]|-|列标题|String类型数组
|itemHeight|[int]|35|行高|单位px
|itemShowCount|[int]|7|同时显示几行|取值范围3, 5, 7, 9
|headerHeight|[int]|44|标题高度|单位px
|transition|[String]|-|动画名称|采用vue的transition，用于创建及销毁
|isLoading|[Boolean]|false|是否显示加载中动画|标示一种状态，一般用于加载异步数据过程
|closeText|[String]|取消|关闭按钮文字|-
|sureText|[String]|确定|确认按钮文字|-
|action|(Function)|-|回调函数|回调函数参数格式为:{type: 'change submit cancel', target: 0, data: {...}}
## 示例工程

## 注意事项

## 已知问题
