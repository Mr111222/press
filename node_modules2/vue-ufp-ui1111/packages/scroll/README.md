# ui-scroll

## 概述

下拉刷新组件

## 安装

```bash
npm i vue-ufp-ui-scroll
```

## 配置

::: demo 在`ufp-framework.js`文件中添加如下配置

```javascript
module.exports = {
  plugins: [
    [
      "ui",
      {
        components: ["scroll"]
      }
    ]
  ]
};
```

:::

## 使用

::: demo 示例

```html
<style scoped lang="scss">
  .nomral {
    overflow: hidden;
    background-color: #ffcdea;
    position: relative;
    height: 400px;
    width: 500px;
  }
  .slot {
    overflow: hidden;
    background-color: #eacdff;
    position: relative;
    height: 400px;
    width: 500px;
  }
  .list {
    overflow: hidden;
    background-color: #fff;
    position: relative;
    height: 400px;
    width: 500px;
    ul {
      li {
        background-color: #eee;
        border-bottom: 1px solid #ddd;
        color: #666;
        display: flex;
        line-height: 32px;
        padding: 0 8px;
        position: relative;
        .id {
          flex: 1;
        }
        .data {
          flex: 2;
        }
      }
    }
  }
  .load-bar {
    text-align: center;
    padding: 80px 0;
    font-size: 18px;
  }
</style>
<template>
  <div class="scroll">
    <cb-scroll class="nomral" @action="action1">
      <ul>
        <li v-for="item in list1" :key="'list1' + item.id">
          <div class="id">{{item.id}}</div>
          <div class="data">{{item.d1}}</div>
          <div class="data">{{item.d2}}</div>
        </li>
      </ul>
    </cb-scroll>
    <br />修改状态文本示例<br />
    <cb-scroll
      class="list"
      @action="action2"
      :pullup-txt="pullupTxt"
      :pulldown-txt="pulldownTxt"
      :loading-txt="loadingTxt"
      :nodata-txt="nodataTxt"
    >
      <ul>
        <li v-for="item in list2" :key="'list2' + item.id">
          <div class="id">{{item.id}}</div>
          <div class="data">{{item.d1}}</div>
          <div class="data">{{item.d2}}</div>
        </li>
      </ul> </cb-scroll
    ><br />使用插槽实例<br />
    <cb-scroll class="slot" @action="action3">
      <div slot="loading">
        <div class="load-bar"><cb-icon type="load-c"></cb-icon>loading</div>
      </div>
      <ul>
        <li v-for="item in list3" :key="'list3' + item.id">
          <div class="id">{{item.id}}</div>
          <div class="data">{{item.d1}}</div>
          <div class="data">{{item.d2}}</div>
        </li>
      </ul>
    </cb-scroll>
  </div>
</template>
<script>
  export default {
    data() {
      return {
        list1: [],
        list2: [],
        list3: [],
        pullupTxt: "数据过时了？",
        pulldownTxt: "偷偷告诉你还有更多数据哦",
        loadingTxt: "阿信正在努力获取数据",
        nodataTxt: "我也是有底线的"
      };
    },
    methods: {
      action1(opts) {
        this.action(opts, 1);
      },
      action2(opts) {
        this.action(opts, 2);
      },
      action3(opts) {
        this.action(opts, 3);
      },
      action(opts, target) {
        if (opts.type === "nomral") {
          this.pullupTxt = "数据过时了？";
          this.pulldownTxt = "偷偷告诉你还有更多数据哦";
        } else if (opts.type === "prerefresh") {
          this.pullupTxt = "放开我，加载最新数据";
        } else if (opts.type === "preload") {
          this.pulldownTxt = "放开我，加载更多数据";
        } else if (opts.type === "refresh") {
          if (target === 1) this.list1 = [];
          if (target === 2) this.list2 = [];
          if (target === 3) this.list3 = [];
          this.loadData(1, opts.cb, target);
        } else if (opts.type === "loadmore") {
          this.loadData(opts.page, opts.cb, target);
        }
      },
      loadData(pageNo, done, target) {
        setTimeout(() => {
          let date = [];
          for (let i = 1; i < 21; i++) {
            date.push({
              id: (pageNo - 1) * 20 + i,
              d1: `第${pageNo}页第${i}条数据1`,
              d2: `第${pageNo}页第${i}条数据2`
            });
          }
          if (target === 1) this.list1 = this.list1.concat(date);
          if (target === 2) this.list2 = this.list2.concat(date);
          if (target === 3) this.list3 = this.list3.concat(date);
          if (pageNo >= 3) {
            done(false); // 表示没有更多页
          } else {
            done(true);
          }
        }, 800);
      }
    }
  };
</script>
```

:::

## 参数

|      属性      |   类型   |                           说明                           |    默认值    |
| :------------: | :------: | :------------------------------------------------------: | :----------: |
|   pullup-txt    |  String  |                     下拉刷新的提示语                     |   下拉刷新   |
|  pulldown-txt   |  String  |                   上拉加载更多的提示语                   | 上拉加载更多 |
|   loading-txt   |  String  |                    数据加载中的提示语                    |  数据加载中  |
|   nodata-txt    |  String  |                   没有更多数据的提示语                   | 没有更多数据 |
|    bg-color     |  String  |                         背景颜色                         |      -       |
|   filter-key    |  String  | 数据过滤的唯一 key，也可以通过 filter 方法(详见示例)实现 |
| scroll-listener | Function |         滚动监听事件，不建议使用（见注意事项 2）         |
|      type      |  String  |   刷新状态,normal/prerefresh/refresh/preload/loadmore    |    normal    |

::: warning
type 的取值范围如下
'nomral', // 正常，用于滑动出‘刷新前’/‘加载前’再滑动回去，只有 type 参数
<br />
'prerefresh', // 刷新前，只有 type 参数
<br />
'refresh', // 刷新中，有 type 和 cb 参数
<br />
'preload', // 加载更多前，只有 type 参数
<br />
'loadmore', // 加载更多中，有 type、page 和 cb 参数
:::

### Slot

|   name   |         说明          |
| :------: | :-------------------: |
|    -     | 默认插槽: scroll 主体 | - |
|  pullup  |  下拉刷新效果的插槽   | - |
| loading  | 数据加载中效果的插槽  | - |
| pulldown |   上拉加载更多插槽    | - |
|  nodata  |   没有更多数据插槽    | - |

### Events

| 事件名称 |         说明          |                                 回调参数                                 |
| :------: | :-------------------: | :----------------------------------------------------------------------: |
|  action  | 触发刷新,加载时的回调 | 回调函数有一个参数，标示有没有更多页，该参数存在且为 true 时表示有更多页 |

## 注意事项

::: tip
1、目前只支持竖向滚动
:::
::: tip
2、因为滚动监听事件调用非常频繁，会增加脚本运算量，降低程序性能，不建议使用！改方法有一个参数：滚动条 y 位置
:::

## 已知问题
